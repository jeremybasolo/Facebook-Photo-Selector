!function(a){a.fn.fbphotoselector=function(t){var o=a.extend({},a.fn.fbphotoselector.defaults,t);return this.each(function(){function t(c){e.html(o.loadingText),FB.api("/me/albums",function(s){var l="<ul class='fbAlbums'>",u=s.data,r=u.length;if(o.albumsByPage>0&&o.albumsByPage<u.length){var h=Math.ceil(u.length/o.albumsByPage);r=o.albumsByPage}for(var m=0,b=r;m<b;m++)l+=n(u[m],c);l+="</ul>";var g="";if(!0===o.breadcrumb&&(g="<nav class='breadcrumb'>Albums</nav>"),g+=l,o.albumsByPage>0&&o.albumsByPage<u.length){for(var f="<nav class='pagination'><ul>",m=0,b=h;m<b;m++)numPage=m+1,f+="<li><a ",1==numPage&&(f+="class='current'"),f=f+" href='javascript:void(0);'>"+numPage+"</a></li>";g+=f+="</ul></nav>"}e.html(g),a(".pagination ul li a").click(function(){a(".pagination ul li a").removeClass("current"),a(this).addClass("current");for(var t=a(this).html(),i=o.albumsByPage*(t-1),s="",l=i,r=i+o.albumsByPage;l<r;l++){var h=u[l];void 0!==h&&(s+=n(h,c))}a("ul.fbAlbums",e).html(s),a(".albumLink",e).click(function(){p(a(this))})});var p=function(n){var s=a("p",n).html();e.html(o.loadingText),FB.api("/"+n.data("id")+"/photos",function(n){var l=n.data,u=l.length,r="<ul class='fbPhotos'>";if(o.photosByPage>0&&o.photosByPage<l.length){var h=Math.ceil(l.length/o.photosByPage);u=o.photosByPage}for(var m=0,b=u;m<b;m++)r+=i(l[m],c);r+="</ul>";var g="";!0===o.breadcrumb&&(g="<nav class='breadcrumb'><a class='albumBack' href='javascript:void(0);'>Albums</a> > "+s+"</nav>");var f="<a class='btn btnBack' href='javascript:void(0);'>"+o.backText+"</a>";if(!0===o.backButtonOnTop&&(g+=f),g+=r,o.photosByPage>0&&o.photosByPage<l.length){for(var p="<nav class='pagination'><ul>",m=0,b=h;m<b;m++)numPage=m+1,p+="<li><a ",1==numPage&&(p+="class='current'"),p=p+" href='javascript:void(0);'>"+numPage+"</a></li>";g+=p+="</ul></nav>"}!0===o.backButtonOnBottom&&(g+=f),e.html(g),a(".pagination ul li a").click(function(){a(".pagination ul li a").removeClass("current"),a(this).addClass("current");for(var t=a(this).html(),n=o.photosByPage*(t-1),s="",u=n,r=n+o.photosByPage;u<r;u++){var h=l[u];void 0!==h&&(s+=i(h,c))}a("ul.fbPhotos",e).html(s),a(".photoLink",e).click(function(){d(a(this))})}),a(".albumBack, .btnBack",e).click(function(){t(c)});var d=function(a){var t={id:a.data("id"),image:a.data("image"),thumbnail:a.data("thumbnail")};o.onSelect(t)};a(".photoLink",e).click(function(){d(a(this))})})};a(".albumLink",e).click(function(){p(a(this))})})}function n(a,t){var n="";return n+="<li>",n=n+"<a href='javascript:void(0);' data-id='"+a.id+"' class='albumLink'>",n=n+"<img src='https://graph.facebook.com/"+a.id+"/picture?type="+o.sizeAlbum+"&access_token="+t+"'>",n=n+"<p>"+a.name+"</p>",n+="</a>",n+="</li>"}function i(a,t){var n="";return n+="<li>",n=n+"<a href='javascript:void(0);' data-id='"+a.id+"' data-image='https://graph.facebook.com/"+a.id+"/picture?type=normal&access_token="+t+"' data-thumbnail='https://graph.facebook.com/"+a.id+"/picture?type=thumbnail&access_token="+t+"' class='photoLink'>",n=n+"<img src='https://graph.facebook.com/"+a.id+"/picture?type="+o.sizePhoto+"&access_token="+t+"'>",n+="</a>",n+="</li>"}var e=a(this);FB.getLoginStatus(function(o){"connected"===o.status?t(o.authResponse.accessToken):(e.html("<a class='facebookLogin' href=''>Login with facebook</a>"),a(".facebookLogin").click(function(){return FB.login(function(a){a.authResponse&&t(a.authResponse.accessToken)},{scope:"user_photos"}),!1}))})})},a.fn.fbphotoselector.defaults={breadcrumb:!0,backButtonOnTop:!1,backButtonOnBottom:!0,sizeAlbum:"thumbnail",sizePhoto:"thumbnail",loadingText:"Loading...",backText:"Back",albumsByPage:0,photosByPage:0,onSelect:function(a){a.id,a.image,a.thumbnail}}}(jQuery);